<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc version 1.7.5 (Ruby 3.0.2) -->


<!DOCTYPE rfc  [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

]>


<rfc ipr="full3978trust200902" docName="draft-ietf-acme-scoped-dns-challenges-00" category="std" consensus="true" tocInclude="true" sortRefs="true" symRefs="true">
  <front>
    <title abbrev="ACME-SCOPED-DNS-CHALLENGES">Automated Certificate Management Environment (ACME) DNS Labeled With ACME Account ID Challenge</title>

    <author fullname="Antonios A. Chariton">
      <organization>Independent Contributor</organization>
      <address>
        <email>daknob@daknob.net</email>
      </address>
    </author>
    <author fullname="Amir A. Omidi">
      <organization>Spirl</organization>
      <address>
        <email>amir@aaomidi.com</email>
      </address>
    </author>
    <author fullname="James Kasten">
      <organization>Google</organization>
      <address>
        <email>jdkasten@google.com</email>
      </address>
    </author>
    <author fullname="Fotis Loukos">
      <organization>Google</organization>
      <address>
        <email>fotisl@google.com</email>
      </address>
    </author>
    <author fullname="Stanislaw A. Janikowski">
      <organization>Google</organization>
      <address>
        <email>stanwise@google.com</email>
      </address>
    </author>

    <date year="2024" month="February" day="10"/>

    <area>Security</area>
    <workgroup>Automated Certificate Management Environment</workgroup>
    <keyword>acme</keyword>

    <abstract>


<?line 53?>

<t>This document outlines a new challenge for the ACME protocol, enabling an ACME
client to answer a domain control validation challenge from an ACME server
using a DNS resource linked to the ACME Account ID. This allows multiple
systems or environments to handle challenge-solving for a single domain.</t>



    </abstract>

    <note title="About This Document" removeInRFC="true">
      <t>
        The latest revision of this draft can be found at <eref target="https://aaomidi.github.io/draft-ietf-acme-dns-account-challenge"/>.
        Status information for this document may be found at <eref target="https://datatracker.ietf.org/doc/draft-ietf-acme-scoped-dns-challenges/"/>.
      </t>
      <t>
        Discussion of this document takes place on the
        WG Working Group mailing list (<eref target="mailto:acme@ietf.org"/>),
        which is archived at <eref target="https://datatracker.ietf.org/wg/acme/about/"/>.
        Subscribe at <eref target="https://www.ietf.org/mailman/listinfo/acme/"/>.
      </t>
      <t>Source for this draft and an issue tracker can be found at
        <eref target="https://github.com/aaomidi/draft-ietf-acme-dns-account-challenge"/>.</t>
    </note>


  </front>

  <middle>


<?line 60?>

<section anchor="introduction"><name>Introduction</name>

<t>The <spanx style="verb">dns-01</spanx> challenge specified in section 8.4 of <xref target="RFC8555"/> requires that
ACME clients validate the domain under the <spanx style="verb">_acme-challenge</spanx> label for the
<spanx style="verb">TXT</spanx> record. This label creates several limiations in domain validation.</t>

<t>First, the <spanx style="verb">_acme-challenge</spanx> label does not specify if the authorization is
intended for a specific host, a wildcard domain, or a domain and all of its
subdomains. Consequently, domain owners who may be delegating or provisioning
authorization labels for a domain must concede control over the domain and all
subdomains, violating the principle of least privilege.</t>

<t>Furthermore, since each domain only has a single authorization label, it creates an impediment
limiting the number of other entities domain validation can be delegated to.
Delegating authorization to an entity requires the use of CNAME records, which can only used once
per DNS name (or in this case, once per authorization label). This limitation requires that
operators to pick a single ACME challenge solver for their domain name.</t>

<t>In multi-region deployments, where separate availability zones
serve the same content, and dependencies across them are avoided, operators need
a way to obtain a separate certificate per zone, for the same domain name.
Similarly, in cases of zero-downtime migration, two different setups of the
infrastructure may coexist for a long period of time, and both need access to valid
certificates.</t>

<t>This document specifies two new challenge types. <spanx style="verb">dns-02</spanx> and <spanx style="verb">dns-account-01</spanx>, which aim to address these deficiencies.</t>

<t>This work follows all recommendations set forth in "Domain Control
Validation using DNS" <xref target="I-D.draft-ietf-dnsop-domain-verification-techniques"></xref>.</t>

<t>This RFC does not intend to deprecate the <spanx style="verb">dns-01</spanx> challenge specified in
<xref target="RFC8555"/>. Since these new challenges do not modify any pre-existing challenges,
the ability to complete the <spanx style="verb">dns-02</spanx> or <spanx style="verb">dns-account-01</spanx> challenge requires ACME server
operators to deploy new changes to their codebase. This makes adopting and using these
challenges an opt-in process.</t>

<section anchor="dns-02"><name>DNS-02</name>

<t>The <spanx style="verb">dns-02</spanx> challenge adds onto <spanx style="verb">dns-01</spanx> by introducing a scoping mechanism
to the domain authorization label. This allows for the client to specify if the
intended domain validation is for a specific host, a wildcard domain, or a domain
and all of its subdomains.</t>

</section>
<section anchor="dns-account-01"><name>DNS-ACCOUNT-01</name>

<t>The <spanx style="verb">dns-account-01</spanx> challenge leverages the ACME Account Resource URL to present
an account-unique stable challenge to an ACME server. This challenge allows any
domain name to delegate its domain validation to more than one service through
unique per ACME account DNS records.</t>

<t>With this new challenge, domain validation of the same DNS name can be done through
different authorization labels. Since these authorization labels will depend on the ACME
account KID (<xref section="6.2" sectionFormat="comma" target="RFC8555"/>), any number of them can be generated in advance.
This allows all required <spanx style="verb">CNAME</spanx> records for domain validation delegation to be constructed
statically.</t>

</section>
</section>
<section anchor="conventions-and-definitions"><name>Conventions and Definitions</name>

<t>The key words "<bcp14>MUST</bcp14>", "<bcp14>MUST NOT</bcp14>", "<bcp14>REQUIRED</bcp14>", "<bcp14>SHALL</bcp14>", "<bcp14>SHALL
NOT</bcp14>", "<bcp14>SHOULD</bcp14>", "<bcp14>SHOULD NOT</bcp14>", "<bcp14>RECOMMENDED</bcp14>", "<bcp14>NOT RECOMMENDED</bcp14>",
"<bcp14>MAY</bcp14>", and "<bcp14>OPTIONAL</bcp14>" in this document are to be interpreted as
described in BCPÂ 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

<?line -18?>

</section>
<section anchor="dns-02-challenge"><name>DNS-02 Challenge</name>

<t>When the identifier being validated is a domain name, the client can prove control of that domain by provisioning a <spanx style="verb">TXT</spanx> resource record containing a designated value for a specific validation domain name.</t>

<t><list style="symbols">
  <t>type (required, string): The string "dns-02".</t>
  <t>token (required, string): A random value that uniquely identifies the challenge. This value <bcp14>MUST</bcp14> have at least 128 bits of entropy. It <bcp14>MUST NOT</bcp14> contain any characters outside the base64url alphabet, including padding characters ("="). See <xref target="RFC4086"/> for additional information on additional requirements for secure randomness.</t>
</list></t>

<figure><artwork><![CDATA[
{
    "type": "dns-02",
    "url": "https://example.com/acme/chall/i00MGYwLWIx",
    "status": "pending",
    "token": "ODE4OWY4NTktYjhmYS00YmY1LTk5MDgtZTFjYTZmNjZlYTUx"
}
]]></artwork></figure>

<t>A client can fulfill this challenge by performing the following steps:</t>

<t><list style="symbols">
  <t>Construct a key authorization <xref section="8.1" sectionFormat="comma" target="RFC8555"/> from the <spanx style="verb">token</spanx> value provided in the challenge and the client's account key</t>
  <t>Compute the SHA-256 digest <xref target="FIPS180-4"/> of the key authorization</t>
  <t>Construct the validation domain name by specifying the scope for the domain name being validated:  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
"_acme-" || <SCOPE> ||"-challenge"
]]></artwork></figure>
  <list style="symbols">
      <t>SCOPE is
      <list style="symbols">
          <t>"host" if the associated authorization applies only to the specific host name and no labels beneath it</t>
          <t>"wildcard" if the associated authorization is for a wildcard domain and contains the <spanx style="verb">wildcard</spanx> field set to true (<xref section="7.1.4" sectionFormat="comma" target="RFC8555"/>)</t>
          <t>"domain" if the authorization is for both the host and all subdomains by containing the <spanx style="verb">subdomainAuthAllowed</spanx> field set to true (<xref section="4.1" sectionFormat="comma" target="RFC9444"/>).</t>
        </list></t>
      <t>The <spanx style="verb">"||"</spanx> operator indicates concatenation of strings</t>
    </list></t>
  <t>Provision a DNS <spanx style="verb">TXT</spanx> record with the base64url digest value under the constructed domain validation name  <vspace blankLines='1'/>
For example, if the domain name being validated is the wildcard of <spanx style="verb">*.example.org</spanx> then the client would provision the following DNS record:  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
_acme-wildcard-challenge.example.org 300 IN TXT "LoqXcYV8...jxAjEuX0.9jg46WB3...fm21mqTI"
]]></artwork></figure>
  <vspace blankLines='1'/>
(In the above, "..." indicates that the token and the JWK thumbprint in the key authorization have been truncated to fit on the page.)</t>
  <t>Respond to the ACME server with an empty object ({}) to acknowledge that the challenge can be validated by the server  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
POST /acme/chall/Rg5dV14Gh1Q
Host: example.com
Content-Type: application/jose+json

{
  "protected": base64url({
    "alg": "ES256",
    "kid": "https://example.com/acme/acct/evOfKhNU60wg",
    "nonce": "SS2sSl1PtspvFZ08kNtzKd",
    "url": "https://example.com/acme/chall/Rg5dV14Gh1Q"
  }),
  "payload": base64url({}),
  "signature": "Q1bURgJoEslbD1c5...3pYdSMLio57mQNN4"
}
]]></artwork></figure>
  </t>
</list></t>

<t>On receiving a response, the server constructs and stores the key authorization from the challenge <spanx style="verb">token</spanx> value.</t>

<t>To validate the <spanx style="verb">dns-02</spanx> challenge, the server performs the following steps:</t>

<t><list style="symbols">
  <t>Compute the SHA-256 digest <xref target="FIPS180-4"/> of the stored key authorization</t>
  <t>Compute the validation domain name with the scope of the associated authorization similiar to the client</t>
  <t>Query for <spanx style="verb">TXT</spanx> records for the validation domain name</t>
  <t>Verify that the contents of one of the <spanx style="verb">TXT</spanx> records match the digest value</t>
</list></t>

<t>If all the above verifications succeed, then the validation is successful. If no DNS record is found, or DNS record and response payload do not pass these checks, then the server <bcp14>MUST</bcp14> fail the validation and mark the challenge as invalid.</t>

<t>The client <bcp14>SHOULD</bcp14> de-provision the resource record(s) provisioned for this challenge once the challenge is complete, i.e., once the "status" field of the challenge has the value "valid" or "invalid".</t>

<section anchor="errors"><name>Errors</name>

<t>The server <bcp14>SHOULD</bcp14> follow the guidelines set in <xref section="6.7" sectionFormat="comma" target="RFC8555"/> for error conditions that occur during challenge validation.</t>

</section>
</section>
<section anchor="dns-account-01-challenge"><name>DNS-ACCOUNT-01 Challenge</name>

<t>When the identifier being validated is a domain name, the client can prove control of that domain by provisioning a <spanx style="verb">TXT</spanx> resource record containing a designated value for a specific validation domain name.</t>

<t><list style="symbols">
  <t>type (required, string): The string "dns-account-01".</t>
  <t>token (required, string): A random value that uniquely identifies the challenge. This value <bcp14>MUST</bcp14> have at least 128 bits of entropy. It <bcp14>MUST NOT</bcp14> contain any characters outside the base64url alphabet, including padding characters ("="). See <xref target="RFC4086"/> for additional information on additional requirements for secure randomness.</t>
</list></t>

<figure><artwork><![CDATA[
{
    "type": "dns-account-01",
    "url": "https://example.com/acme/chall/i00MGYwLWIx",
    "status": "pending",
    "token": "ODE4OWY4NTktYjhmYS00YmY1LTk5MDgtZTFjYTZmNjZlYTUx"
}
]]></artwork></figure>

<t>A client can fulfill this challenge by performing the following steps:</t>

<t><list style="symbols">
  <t>Construct a key authorization <xref section="8.1" sectionFormat="comma" target="RFC8555"/> from the <spanx style="verb">token</spanx> value provided in the challenge and the client's account key</t>
  <t>Compute the SHA-256 digest <xref target="FIPS180-4"/> of the key authorization</t>
  <t>Construct the validation domain name by prepending the following two labels to the domain name being validated:  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
"_" || base32(SHA-256(<ACCOUNT_RESOURCE_URL>)[0:10]) || "._acme-" || <SCOPE> ||"-challenge"
]]></artwork></figure>
  <list style="symbols">
      <t>SHA-256 is the SHA hashing operation defined in <xref target="RFC6234"/></t>
      <t><spanx style="verb">[0:10]</spanx> is the operation that selects the first ten bytes (bytes 0 through 9 inclusive) from the previous SHA-256 operation</t>
      <t>base32 is the operation defined in <xref target="RFC4648"/></t>
      <t>ACCOUNT_RESOURCE_URL is defined in <xref section="7.3" sectionFormat="comma" target="RFC8555"/> as the value in the <spanx style="verb">Location</spanx> header field</t>
      <t>SCOPE is
      <list style="symbols">
          <t>"host" if the associated authorization applies only to the specific host name and no labels beneath it</t>
          <t>"wildcard" if the associated authorization is for a wildcard domain and contains the <spanx style="verb">wildcard</spanx> field set to true (<xref section="7.1.4" sectionFormat="comma" target="RFC8555"/>)</t>
          <t>"domain" if the authorization is for both the host and all subdomains by containing the <spanx style="verb">subdomainAuthAllowed</spanx> field set to true (<xref section="4.1" sectionFormat="comma" target="RFC9444"/>).</t>
        </list></t>
      <t>The <spanx style="verb">"||"</spanx> operator indicates concatenation of strings</t>
    </list></t>
  <t>Provision a DNS <spanx style="verb">TXT</spanx> record with the base64url digest value under the constructed domain validation name  <vspace blankLines='1'/>
For example, if the domain name being validated is <spanx style="verb">*.example.org</spanx>, and the account URL of <spanx style="verb">https://example.com/acme/acct/ExampleAccount</spanx> then the client would provision the following DNS record:  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
_ujmmovf2vn55tgye._acme-wildcard-challenge.example.org 300 IN TXT "LoqXcYV8...jxAjEuX0.9jg46WB3...fm21mqTI"
]]></artwork></figure>
  <vspace blankLines='1'/>
(In the above, "..." indicates that the token and the JWK thumbprint in the key authorization have been truncated to fit on the page.)</t>
  <t>Respond to the ACME server with an empty object ({}) to acknowledge that the challenge can be validated by the server  <vspace blankLines='1'/>
    <figure><artwork><![CDATA[
POST /acme/chall/Rg5dV14Gh1Q
Host: example.com
Content-Type: application/jose+json

{
  "protected": base64url({
    "alg": "ES256",
    "kid": "https://example.com/acme/acct/evOfKhNU60wg",
    "nonce": "SS2sSl1PtspvFZ08kNtzKd",
    "url": "https://example.com/acme/chall/Rg5dV14Gh1Q"
  }),
  "payload": base64url({}),
  "signature": "Q1bURgJoEslbD1c5...3pYdSMLio57mQNN4"
}
]]></artwork></figure>
  </t>
</list></t>

<t>On receiving a response, the server constructs and stores the key authorization from the challenge <spanx style="verb">token</spanx> value and the current client account key.</t>

<t>To validate the <spanx style="verb">dns-account-01</spanx> challenge, the server performs the following steps:</t>

<t><list style="symbols">
  <t>Compute the SHA-256 digest <xref target="FIPS180-4"/> of the stored key authorization</t>
  <t>Compute the validation domain name with the account URL of the ACME account requesting validation and the associated authorization, similar to the client logic</t>
  <t>Query for <spanx style="verb">TXT</spanx> records for the validation domain name</t>
  <t>Verify that the contents of one of the <spanx style="verb">TXT</spanx> records match the digest value</t>
</list></t>

<t>If all the above verifications succeed, then the validation is successful. If no DNS record is found, or DNS record and response payload do not pass these checks, then the server <bcp14>MUST</bcp14> fail the validation and mark the challenge as invalid.</t>

<t>The client <bcp14>SHOULD</bcp14> de-provision the resource record(s) provisioned for this challenge once the challenge is complete, i.e., once the "status" field of the challenge has the value "valid" or "invalid".</t>

<section anchor="errors-1"><name>Errors</name>

<t>The server <bcp14>SHOULD</bcp14> follow the guidelines set in <xref section="6.7" sectionFormat="comma" target="RFC8555"/> for error conditions that occur during challenge validation.</t>

<t>If the server is unable to find a <spanx style="verb">TXT</spanx> record for the validation domain name, it <bcp14>SHOULD</bcp14> include the account URL it used to construct the validation domain name in the problem document. Clients <bcp14>MUST NOT</bcp14> use or rely on the presence of this field to construct the validation domain name.</t>

</section>
<section anchor="implementation-considerations"><name>Implementation Considerations</name>

<t>As this challenge creates strong dependency on the <spanx style="verb">kid</spanx> account identifier, the server <bcp14>SHOULD</bcp14> ensure that the account identifier is not changed during the lifetime of the account.</t>

</section>
</section>
<section anchor="security-considerations"><name>Security Considerations</name>

<t>These challenges follows the recommendations set out in "Domain Control Validation using DNS" <xref target="I-D.draft-ietf-dnsop-domain-verification-techniques"/> for supporting multiple intermediates within the context of <xref target="RFC8555"/>.</t>

<t>In both <spanx style="verb">dns-account-01</spanx> and <spanx style="verb">dns-02</spanx>, the same security considerations apply for the integrity of authorizations (<xref section="10.2" sectionFormat="comma" target="RFC8555"/>) and DNS security (<xref section="11.2" sectionFormat="comma" target="RFC8555"/>) as in the original specification for <spanx style="verb">dns-01</spanx>. They both differ from <spanx style="verb">dns-01</spanx> in that the challenges are scoped to the particular name being validated without relying upon CAA (<xref target="RFC8659"/>).</t>

<section anchor="dns-account-01-1"><name>DNS-ACCOUNT-01</name>

<t>To allow for seamless account key rollover without the label changing, the dynamic part of the label depends on the ACME account and not the account key. This allows for long-lived labels, without the security considerations of keeping the account key static.</t>

<t>In terms of the construction of the account label prepended to the domain name, there is no need for a cryptographic hash. The goal is to simply create a long-lived and statistically distinct label of minimal size. SHA-256 was chosen due to its existing use in the <spanx style="verb">dns-01</spanx> challenge (<xref section="8.1" sectionFormat="comma" target="RFC8555"/>).</t>

<t>The first 10 bytes were picked as a tradeoff: the value needs to be short enough to stay lower than the size limits for DNS (<xref section="2.3.4" sectionFormat="comma" target="RFC1035"/>), long enough to provide sufficient probability of collision avoidance across ACME accounts, and just the right size to have Base32 require no padding. As the algorithm is used for a uniform distribution of inputs, and not for integrity, we do not consider the trimming a security issue.</t>

</section>
</section>
<section anchor="iana-considerations"><name>IANA Considerations</name>

<section anchor="acme-validation-method"><name>ACME Validation Method</name>

<t>The "ACME Validation Methods" registry is to be updated to include the following entries:</t>

<figure><artwork><![CDATA[
label: dns-02
identifier-type: dns
ACME: Y
Reference: This document

label: dns-account-01
identifier-type: dns
ACME: Y
Reference: This document
]]></artwork></figure>

</section>
</section>


  </middle>

  <back>


    <references title='Normative References' anchor="sec-normative-references">

<reference anchor="FIPS180-4" target="https://csrc.nist.gov/publications/detail/fips/180/4/final">
  <front>
    <title>Secure Hash Standard (SHS)</title>
    <author >
      <organization>National Institute of Standards and Technology</organization>
    </author>
    <date year="2015" month="August"/>
  </front>
</reference>


<reference anchor="RFC8555">
  <front>
    <title>Automatic Certificate Management Environment (ACME)</title>
    <author fullname="R. Barnes" initials="R." surname="Barnes"/>
    <author fullname="J. Hoffman-Andrews" initials="J." surname="Hoffman-Andrews"/>
    <author fullname="D. McCarney" initials="D." surname="McCarney"/>
    <author fullname="J. Kasten" initials="J." surname="Kasten"/>
    <date month="March" year="2019"/>
    <abstract>
      <t>Public Key Infrastructure using X.509 (PKIX) certificates are used for a number of purposes, the most significant of which is the authentication of domain names. Thus, certification authorities (CAs) in the Web PKI are trusted to verify that an applicant for a certificate legitimately represents the domain name(s) in the certificate. As of this writing, this verification is done through a collection of ad hoc mechanisms. This document describes a protocol that a CA and an applicant can use to automate the process of verification and certificate issuance. The protocol also provides facilities for other certificate management functions, such as certificate revocation.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="8555"/>
  <seriesInfo name="DOI" value="10.17487/RFC8555"/>
</reference>

<reference anchor="RFC2119">
  <front>
    <title>Key words for use in RFCs to Indicate Requirement Levels</title>
    <author fullname="S. Bradner" initials="S." surname="Bradner"/>
    <date month="March" year="1997"/>
    <abstract>
      <t>In many standards track documents several words are used to signify the requirements in the specification. These words are often capitalized. This document defines these words as they should be interpreted in IETF documents. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
    </abstract>
  </front>
  <seriesInfo name="BCP" value="14"/>
  <seriesInfo name="RFC" value="2119"/>
  <seriesInfo name="DOI" value="10.17487/RFC2119"/>
</reference>

<reference anchor="RFC8174">
  <front>
    <title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
    <author fullname="B. Leiba" initials="B." surname="Leiba"/>
    <date month="May" year="2017"/>
    <abstract>
      <t>RFC 2119 specifies common key words that may be used in protocol specifications. This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the defined special meanings.</t>
    </abstract>
  </front>
  <seriesInfo name="BCP" value="14"/>
  <seriesInfo name="RFC" value="8174"/>
  <seriesInfo name="DOI" value="10.17487/RFC8174"/>
</reference>

<reference anchor="RFC4086">
  <front>
    <title>Randomness Requirements for Security</title>
    <author fullname="D. Eastlake 3rd" initials="D." surname="Eastlake 3rd"/>
    <author fullname="J. Schiller" initials="J." surname="Schiller"/>
    <author fullname="S. Crocker" initials="S." surname="Crocker"/>
    <date month="June" year="2005"/>
    <abstract>
      <t>Security systems are built on strong cryptographic algorithms that foil pattern analysis attempts. However, the security of these systems is dependent on generating secret quantities for passwords, cryptographic keys, and similar quantities. The use of pseudo-random processes to generate secret quantities can result in pseudo-security. A sophisticated attacker may find it easier to reproduce the environment that produced the secret quantities and to search the resulting small set of possibilities than to locate the quantities in the whole of the potential number space.</t>
      <t>Choosing random quantities to foil a resourceful and motivated adversary is surprisingly difficult. This document points out many pitfalls in using poor entropy sources or traditional pseudo-random number generation techniques for generating such quantities. It recommends the use of truly random hardware techniques and shows that the existing hardware on many systems can be used for this purpose. It provides suggestions to ameliorate the problem when a hardware solution is not available, and it gives examples of how large such quantities need to be for some applications. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
    </abstract>
  </front>
  <seriesInfo name="BCP" value="106"/>
  <seriesInfo name="RFC" value="4086"/>
  <seriesInfo name="DOI" value="10.17487/RFC4086"/>
</reference>

<reference anchor="RFC6234">
  <front>
    <title>US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</title>
    <author fullname="D. Eastlake 3rd" initials="D." surname="Eastlake 3rd"/>
    <author fullname="T. Hansen" initials="T." surname="Hansen"/>
    <date month="May" year="2011"/>
    <abstract>
      <t>Federal Information Processing Standard, FIPS</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="6234"/>
  <seriesInfo name="DOI" value="10.17487/RFC6234"/>
</reference>

<reference anchor="RFC4648">
  <front>
    <title>The Base16, Base32, and Base64 Data Encodings</title>
    <author fullname="S. Josefsson" initials="S." surname="Josefsson"/>
    <date month="October" year="2006"/>
    <abstract>
      <t>This document describes the commonly used base 64, base 32, and base 16 encoding schemes. It also discusses the use of line-feeds in encoded data, use of padding in encoded data, use of non-alphabet characters in encoded data, use of different encoding alphabets, and canonical encodings. [STANDARDS-TRACK]</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="4648"/>
  <seriesInfo name="DOI" value="10.17487/RFC4648"/>
</reference>

<reference anchor="RFC8659">
  <front>
    <title>DNS Certification Authority Authorization (CAA) Resource Record</title>
    <author fullname="P. Hallam-Baker" initials="P." surname="Hallam-Baker"/>
    <author fullname="R. Stradling" initials="R." surname="Stradling"/>
    <author fullname="J. Hoffman-Andrews" initials="J." surname="Hoffman-Andrews"/>
    <date month="November" year="2019"/>
    <abstract>
      <t>The Certification Authority Authorization (CAA) DNS Resource Record allows a DNS domain name holder to specify one or more Certification Authorities (CAs) authorized to issue certificates for that domain name. CAA Resource Records allow a public CA to implement additional controls to reduce the risk of unintended certificate mis-issue. This document defines the syntax of the CAA record and rules for processing CAA records by CAs.</t>
      <t>This document obsoletes RFC 6844.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="8659"/>
  <seriesInfo name="DOI" value="10.17487/RFC8659"/>
</reference>

<reference anchor="RFC1035">
  <front>
    <title>Domain names - implementation and specification</title>
    <author fullname="P. Mockapetris" initials="P." surname="Mockapetris"/>
    <date month="November" year="1987"/>
    <abstract>
      <t>This RFC is the revised specification of the protocol and format used in the implementation of the Domain Name System. It obsoletes RFC-883. This memo documents the details of the domain name client - server communication.</t>
    </abstract>
  </front>
  <seriesInfo name="STD" value="13"/>
  <seriesInfo name="RFC" value="1035"/>
  <seriesInfo name="DOI" value="10.17487/RFC1035"/>
</reference>




    </references>

    <references title='Informative References' anchor="sec-informative-references">




<reference anchor="I-D.draft-ietf-dnsop-domain-verification-techniques">
   <front>
      <title>Domain Control Validation using DNS</title>
      <author fullname="Shivan Kaul Sahib" initials="S. K." surname="Sahib">
         <organization>Brave Software</organization>
      </author>
      <author fullname="Shumon Huque" initials="S." surname="Huque">
         <organization>Salesforce</organization>
      </author>
      <author fullname="Paul Wouters" initials="P." surname="Wouters">
         <organization>Aiven</organization>
      </author>
      <author fullname="Erik Nygren" initials="E." surname="Nygren">
         <organization>Akamai Technologies</organization>
      </author>
      <date day="17" month="October" year="2023"/>
      <abstract>
	 <t>   Many application services on the Internet need to verify ownership or
   control of a domain in the Domain Name System (DNS).  The general
   term for this process is &quot;Domain Control Validation&quot;, and can be done
   using a variety of methods such as email, HTTP/HTTPS, or the DNS
   itself.  This document focuses only on DNS-based methods, which
   typically involve the application service provider requesting a DNS
   record with a specific format and content to be visible in the
   requester&#x27;s domain.  There is wide variation in the details of these
   methods today.  This document proposes some best practices to avoid
   known problems.

	 </t>
      </abstract>
   </front>
   <seriesInfo name="Internet-Draft" value="draft-ietf-dnsop-domain-verification-techniques-03"/>
   
</reference>

<reference anchor="RFC9444">
  <front>
    <title>Automated Certificate Management Environment (ACME) for Subdomains</title>
    <author fullname="O. Friel" initials="O." surname="Friel"/>
    <author fullname="R. Barnes" initials="R." surname="Barnes"/>
    <author fullname="T. Hollebeek" initials="T." surname="Hollebeek"/>
    <author fullname="M. Richardson" initials="M." surname="Richardson"/>
    <date month="August" year="2023"/>
    <abstract>
      <t>This document specifies how Automated Certificate Management Environment (ACME) can be used by a client to obtain a certificate for a subdomain identifier from a certification authority. Additionally, this document specifies how a client can fulfill a challenge against an ancestor domain but may not need to fulfill a challenge against the explicit subdomain if certification authority policy allows issuance of the subdomain certificate without explicit subdomain ownership proof.</t>
    </abstract>
  </front>
  <seriesInfo name="RFC" value="9444"/>
  <seriesInfo name="DOI" value="10.17487/RFC9444"/>
</reference>




    </references>


<?line 335?>

<section numbered="false" anchor="acknowledgments"><name>Acknowledgments</name>

</section>


  </back>

<!-- ##markdown-source:
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
7qLDPgAA

-->

</rfc>

